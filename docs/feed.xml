<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><atom:link href="http://localhost:4000" rel="self" type="application/rss+xml"/><title></title><link>http://localhost:4000</link><description></description><generator>clj-rss</generator><item><description>&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8" /&gt;&lt;meta content="width=device-width, initial-scale=1.0" name="viewport" /&gt;&lt;meta content="" name="author" /&gt;&lt;meta content="" name="description" /&gt;&lt;title&gt;&lt;/title&gt;&lt;link href="http://localhost:4000/static/css/firn_base.css" rel="stylesheet" /&gt;&lt;link href="http://localhost:4000/static/css/ii.css" rel="stylesheet" /&gt;&lt;/head&gt;&lt;body&gt;&lt;main&gt;&lt;article class="content"&gt;&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="the-ii-blog"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;The ii Blog&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;News, Views, and Tech How-To's from ii.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/article&gt;&lt;section id="recent"&gt;&lt;h2&gt;Recent Posts&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;a class="title" href="deploying-talos-to-equinix"&gt;Cluster-API + Talos + Equinix Metal&lt;/a&gt;&lt;p&gt;A guide to  launching a highly-available cluster with Equinix and Talos&lt;/p&gt;&lt;p&gt;&lt;em&gt;2021-01-21&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;a class="title" href="working-with-orgmode-tables"&gt;Working with Org-Mode Tables: Basics&lt;/a&gt;&lt;p&gt;An introduction to how to create/edit tables with Org-Mode.&lt;/p&gt;&lt;p&gt;&lt;em&gt;2019-03-09&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/main&gt;&lt;/body&gt;&lt;/html&gt;</description><pubDate>Tue, 02 Feb 2021 00:00:00 +0000</pubDate><title>Index</title><link>index</link></item><item><description>&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8" /&gt;&lt;meta content="width=device-width, initial-scale=1.0" name="viewport" /&gt;&lt;meta content="" name="author" /&gt;&lt;meta content="" name="description" /&gt;&lt;title&gt;&lt;/title&gt;&lt;link href="http://localhost:4000/static/css/firn_base.css" rel="stylesheet" /&gt;&lt;link href="http://localhost:4000/static/css/ii.css" rel="stylesheet" /&gt;&lt;/head&gt;&lt;body&gt;&lt;main&gt;&lt;article class="content"&gt;&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="introduction"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Introduction&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;In this guide we will launch a highly-available three Node Kubernetes cluster on Equinix Metal using Talos as the Node OS, as well as bootstrap, and controlPlane provider for Cluster-API.&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;What is &lt;/span&gt;&lt;a class="firn-external" href="https://cluster-api.sigs.k8s.io/" target="_blank"&gt;Cluster-API&lt;/a&gt;&lt;span&gt;? ::&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;Cluster API is a Kubernetes sub-project focused on providing declarative APIs and tooling to simplify provisioning, upgrading, and operating multiple Kubernetes clusters.&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;What is &lt;/span&gt;&lt;a class="firn-external" href="https://www.talos.dev/" target="_blank"&gt;Talos&lt;/a&gt;&lt;span&gt;? ::&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;Talos is a modern OS designed to be secure, immutable, and minimal.&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;What is &lt;/span&gt;&lt;a class="firn-external" href="https://metal.equinix.com/" target="_blank"&gt;Equinix Metal&lt;/a&gt;&lt;span&gt;? ::&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;A globally-available bare metal “as-a-service” that can be deployed and interconnected in minutes.&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;span&gt;The folks over at Equinix Metal have a wonderful heart for supporting Open Source communities.&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Why is this important? :: In general: Orchestrating a container based OS such as Talos (&lt;/span&gt;&lt;a class="firn-external" href="http://flatcar-linux.org/" target="_blank"&gt;Flatcar&lt;/a&gt;&lt;span&gt;, &lt;/span&gt;&lt;a class="firn-external" href="https://getfedora.org/coreos/" target="_blank"&gt;Fedora CoreOS&lt;/a&gt;&lt;span&gt;, or &lt;/span&gt;&lt;a class="firn-external" href="https://rancher.com/products/rancher/" target="_blank"&gt;RancherOS&lt;/a&gt;&lt;span&gt;) shifts focus from the Nodes to the workloads. In terms of Talos: Currently the documentation for running an OS such as Talos in Equinix Metal for Kubernetes with Cluster-API is not so well documented and therefore inaccessible. It's important to fill in the gaps of knowledge.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="dependencies"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Dependencies&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;What you'll need for this guide:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;a class="firn-external" href="https://github.com/talos-systems/talos/releases/tag/v0.8.1" target="_blank"&gt;talosctl&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a class="firn-external" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank"&gt;kubectl&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a class="firn-external" href="https://github.com/packethost/packet-cli" target="_blank"&gt;packet-cli&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;the ID and API token of existing Equinix Metal project&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;an existing Kubernetes cluster with a public IP (such as &lt;/span&gt;&lt;a class="firn-external" href="http://kind.sigs.k8s.io/" target="_blank"&gt;kind&lt;/a&gt;&lt;span&gt;, &lt;/span&gt;&lt;a class="firn-external" href="https://minikube.sigs.k8s.io/" target="_blank"&gt;minikube&lt;/a&gt;&lt;span&gt;, or a cluster already on Equinix Metal)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="prelimiary-steps"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Prelimiary steps&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;In order to talk to Equinix Metal, we'll export environment variables to configure resources and talk via &lt;/span&gt;&lt;code&gt;packet-cli&lt;/code&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Set the correct project to create and manage resources in:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  read -p 'PACKET_PROJECT_ID: ' PACKET_PROJECT_ID
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;The API key for your account or project:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  read -p 'PACKET_API_KEY: ' PACKET_API_KEY
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Export the variables to be accessible from &lt;/span&gt;&lt;code&gt;packet-cli&lt;/code&gt;&lt;span&gt; and &lt;/span&gt;&lt;code&gt;clusterctl&lt;/code&gt;&lt;span&gt; later on:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  export PACKET_PROJECT_ID PACKET_API_KEY PACKET_TOKEN=$PACKET_API_KEY
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;In the existing cluster, a public LoadBalancer IP will be needed. I have already installed nginx-ingress in this cluster, which has got a Service with the cluster's elastic IP.
We'll need this IP address later for use in booting the servers.
If you have set up your existing cluster differently, it'll just need to be an IP that we can use.&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  export LOAD_BALANCER_IP="$(kubectl -n nginx-ingress get svc nginx-ingress-ingress-nginx-controller -o=jsonpath='{.status.loadBalancer.ingress[0].ip}')"
&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="setting-up-cluster-api"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Setting up Cluster-API&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Install Talos providers for Cluster-API bootstrap and controlplane in your existing cluster:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  clusterctl init -b talos -c talos -i packet
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;This will install Talos's bootstrap and controlPlane controllers as well as the Packet / Equinix Metal infrastructure provider.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;Important&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;span&gt; note:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;the &lt;/span&gt;&lt;code&gt;bootstrap-talos&lt;/code&gt;&lt;span&gt; controller in the &lt;/span&gt;&lt;code&gt;cabpt-system&lt;/code&gt;&lt;span&gt; namespace must be running a version greater than &lt;/span&gt;&lt;code&gt;v0.2.0-alpha.8&lt;/code&gt;&lt;span&gt;. The version can be displayed in with &lt;/span&gt;&lt;code&gt;clusterctl upgrade plan&lt;/code&gt;&lt;span&gt; when it's installed.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="setting-up-matchbox"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Setting up Matchbox&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Currently, since Equinix Metal have &lt;/span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;not&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;span&gt; yet added support for Talos, it is necessary to install &lt;/span&gt;&lt;a class="firn-external" href="https://matchbox.psdn.io/" target="_blank"&gt;Matchbox&lt;/a&gt;&lt;span&gt; to boot the servers (There is an &lt;/span&gt;&lt;a class="firn-external" href="https://github.com/packethost/packet-images/issues/26" target="_blank"&gt;issue&lt;/a&gt;&lt;span&gt; in progress and &lt;/span&gt;&lt;a class="firn-external" href="https://feedback.equinixmetal.com/operating-systems/p/talos-as-officially-supported-operating-system" target="_blank"&gt;feedback&lt;/a&gt;&lt;span&gt; for adding support).&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;What is Matchbox? ::&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;Matchbox is a service that matches bare-metal machines to profiles that PXE boot and provision clusters.&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;span&gt;Here is the manifest for a basic matchbox installation:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-yaml"&gt;&lt;code class="language-yaml"&gt;  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: matchbox
  spec:
    replicas: 1
    strategy:
      rollingUpdate:
        maxUnavailable: 1
    selector:
      matchLabels:
        name: matchbox
    template:
      metadata:
        labels:
          name: matchbox
      spec:
        containers:
          - name: matchbox
            image: quay.io/poseidon/matchbox:v0.9.0
            env:
              - name: MATCHBOX_ADDRESS
                value: "0.0.0.0:8080"
              - name: MATCHBOX_LOG_LEVEL
                value: "debug"
            ports:
              - name: http
                containerPort: 8080
            livenessProbe:
              initialDelaySeconds: 5
              httpGet:
                path: /
                port: 8080
            resources:
              requests:
                cpu: 30m
                memory: 20Mi
              limits:
                cpu: 50m
                memory: 50Mi
            volumeMounts:
              - name: data
                mountPath: /var/lib/matchbox
              - name: assets
                mountPath: /var/lib/matchbox/assets
        volumes:
          - name: data
            hostPath:
              path: /var/local/matchbox/data
          - name: assets
            hostPath:
              path: /var/local/matchbox/assets
  ---
  apiVersion: v1
  kind: Service
  metadata:
    name: matchbox
    annotations:
      metallb.universe.tf/allow-shared-ip: nginx-ingress
  spec:
    type: LoadBalancer
    selector:
      name: matchbox
    ports:
      - name: http
        protocol: TCP
        port: 8080
        targetPort: 8080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Save it as &lt;/span&gt;&lt;code&gt;matchbox.yaml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;The manifests above were inspired by the manifests in the &lt;/span&gt;&lt;a class="firn-external" href="https://github.com/poseidon/matchbox/tree/master/contrib/k8s" target="_blank"&gt;matchbox repo&lt;/a&gt;&lt;span&gt;.
For production it might be wise to use:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;an Ingress with full TLS&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;a ReadWriteMany storage provider instead hostPath for scaling&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;With the manifests ready to go, we'll install Matchbox into the &lt;/span&gt;&lt;code&gt;matchbox&lt;/code&gt;&lt;span&gt; namespace on the existing cluster with the following commands:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl create ns matchbox
  kubectl -n matchbox apply -f ./matchbox.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;You may need to patch the &lt;/span&gt;&lt;code&gt;Service.spec.externalIPs&lt;/code&gt;&lt;span&gt; to have an IP to access it from if one is not populated:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox patch \
    service matchbox \
    -p "{\"spec\":{\"externalIPs\":[\"$LOAD_BALANCER_IP\"]}}"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Once the pod is live, We'll need to create a directory structure for storing Talos boot assets:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox exec -it \
    deployment/matchbox -- \
    mkdir -p /var/lib/matchbox/{profiles,groups} /var/lib/matchbox/assets/talos
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Inside the Matchbox container, we'll download the Talos boot assets for Talos version 0.8.1 into the assets folder:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox exec -it \
    deployment/matchbox -- \
    wget -P /var/lib/matchbox/assets/talos \
    https://github.com/talos-systems/talos/releases/download/v0.8.1/initramfs-amd64.xz \
    https://github.com/talos-systems/talos/releases/download/v0.8.1/vmlinuz-amd64
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Now that the assets have been downloaded, run a checksum against them to verify:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox exec -it \
    deployment/matchbox -- \
    sh -c "cd /var/lib/matchbox/assets/talos &amp;&amp; \
      wget -O- https://github.com/talos-systems/talos/releases/download/v0.8.1/sha512sum.txt 2&gt; /dev/null \
      | sed 's,_out/,,g' \
      | grep 'initramfs-amd64.xz\|vmlinuz-amd64' \
      | sha512sum -c -"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Since there's only one Pod in the Matchbox deployment, we'll export it's name to copy files into it:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  export MATCHBOX_POD_NAME=$(kubectl -n matchbox get pods -l name=matchbox -o=jsonpath='{.items[0].metadata.name}')
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a class="firn-external" href="https://matchbox.psdn.io/matchbox/#profiles" target="_blank"&gt;Profiles in Matchbox&lt;/a&gt;&lt;span&gt; are JSON configurations for how the servers should boot, where from, and their kernel args. Save this file as &lt;/span&gt;&lt;code&gt;profile-default-amd64.json&lt;/code&gt;&lt;/p&gt;&lt;pre class="language-json"&gt;&lt;code class="language-json"&gt;  {
    "id": "default-amd64",
    "name": "default-amd64",
    "boot": {
      "kernel": "/assets/talos/vmlinuz-amd64",
      "initrd": [
        "/assets/talos/initramfs-amd64.xz"
      ],
      "args": [
        "initrd=initramfs-amd64.xz",
        "init_on_alloc=1",
        "init_on_free=1",
        "slub_debug=P",
        "pti=on",
        "random.trust_cpu=on",
        "console=tty0",
        "console=ttyS1,115200n8",
        "slab_nomerge",
        "printk.devkmsg=on",
        "talos.platform=packet",
        "talos.config=none"
      ]
    }
  }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a class="firn-external" href="https://matchbox.psdn.io/matchbox/#groups" target="_blank"&gt;Groups in Matchbox&lt;/a&gt;&lt;span&gt; are a way of letting servers pick up profiles based on selectors. Save this file as &lt;/span&gt;&lt;code&gt;group-default-amd64.json&lt;/code&gt;&lt;/p&gt;&lt;pre class="language-json"&gt;&lt;code class="language-json"&gt;  {
    "id": "default-amd64",
    "name": "default-amd64",
    "profile": "default-amd64",
    "selector": {
      "arch": "amd64"
    }
  }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;We'll copy the profile and group into their respective folders:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox \
    cp ./profile-default-amd64.json \
    $MATCHBOX_POD_NAME:/var/lib/matchbox/profiles/default-amd64.json
  kubectl -n matchbox \
    cp ./group-default-amd64.json \
    $MATCHBOX_POD_NAME:/var/lib/matchbox/groups/default-amd64.json
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;List the files to validate that they were written correctly:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox exec -it \
    deployment/matchbox -- \
    sh -c 'ls -alh /var/lib/matchbox/*/'
&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="testing-matchbox"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Testing Matchbox&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Using &lt;/span&gt;&lt;code&gt;curl&lt;/code&gt;&lt;span&gt;, we can verify Matchbox's running state:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  curl http://$LOAD_BALANCER_IP:8080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;To test matchbox, we'll create an invalid userdata configuration for Talos, saving as &lt;/span&gt;&lt;code&gt;userdata.txt&lt;/code&gt;&lt;span&gt;:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-text"&gt;&lt;code class="language-text"&gt;#!talos
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Feel free to use a valid one.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Now let's talk to Equinix Metal to create a server pointing to the Matchbox server:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;   packet-cli device create \
    --hostname talos-pxe-boot-test-1 \
    --plan c1.small.x86 \
    --facility sjc1 \
    --operating-system custom_ipxe \
    --project-id "$PACKET_PROJECT_ID" \
    --ipxe-script-url "http://$LOAD_BALANCER_IP:8080/ipxe?arch=amd64" \
    --userdata-file=./userdata.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;In the meanwhile, we can watch the logs to see how things are:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n matchbox logs deployment/matchbox -f --tail=100
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Looking at the logs, there should be some get requests of resources that will be used to boot the OS.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Notes:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;fun fact: you can run Matchbox on Android using &lt;/span&gt;&lt;a class="firn-external" href="https://f-droid.org/en/packages/com.termux/" target="_blank"&gt;Termux&lt;/a&gt;&lt;span&gt;.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="the-cluster"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;The cluster&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="preparing-the-cluster"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Preparing the cluster&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Here we will declare the template that we will shortly generate our usable cluster from:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-yaml"&gt;&lt;code class="language-yaml"&gt;  kind: TalosControlPlane
  apiVersion: controlplane.cluster.x-k8s.io/v1alpha3
  metadata:
    name: "${CLUSTER_NAME}-control-plane"
  spec:
    version: ${KUBERNETES_VERSION}
    replicas: ${CONTROL_PLANE_MACHINE_COUNT}
    infrastructureTemplate:
      apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
      kind: PacketMachineTemplate
      name: "${CLUSTER_NAME}-control-plane"
    controlPlaneConfig:
      init:
        generateType: init
        configPatches:
          - op: replace
            path: /machine/install
            value:
              disk: /dev/sda
              image: ghcr.io/talos-systems/installer:v0.8.1
              bootloader: true
              wipe: false
              force: false
          - op: add
            path: /machine/kubelet/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/apiServer/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/controllerManager/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/extraManifests
            value:
            - https://github.com/packethost/packet-ccm/releases/download/v1.1.0/deployment.yaml
          - op: add
            path: /cluster/allowSchedulingOnMasters
            value: true
      controlplane:
        generateType: controlplane
        configPatches:
          - op: replace
            path: /machine/install
            value:
              disk: /dev/sda
              image: ghcr.io/talos-systems/installer:v0.8.1
              bootloader: true
              wipe: false
              force: false
          - op: add
            path: /machine/kubelet/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/apiServer/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/controllerManager/extraArgs
            value:
              cloud-provider: external
          - op: add
            path: /cluster/allowSchedulingOnMasters
            value: true
  ---
  apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
  kind: PacketMachineTemplate
  metadata:
    name: "${CLUSTER_NAME}-control-plane"
  spec:
    template:
      spec:
        OS: custom_ipxe
        ipxeURL: "http://${IPXE_SERVER_IP}:8080/ipxe?arch=amd64"
        billingCycle: hourly
        machineType: "${CONTROLPLANE_NODE_TYPE}"
        sshKeys:
          - "${SSH_KEY}"
        tags: []
  ---
  apiVersion: cluster.x-k8s.io/v1alpha3
  kind: Cluster
  metadata:
    name: "${CLUSTER_NAME}"
  spec:
    clusterNetwork:
      pods:
        cidrBlocks:
          - ${POD_CIDR:=192.168.0.0/16}
      services:
        cidrBlocks:
          - ${SERVICE_CIDR:=172.26.0.0/16}
    infrastructureRef:
      apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
      kind: PacketCluster
      name: "${CLUSTER_NAME}"
    controlPlaneRef:
      apiVersion: controlplane.cluster.x-k8s.io/v1alpha3
      kind: TalosControlPlane
      name: "${CLUSTER_NAME}-control-plane"
  ---
  apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
  kind: PacketCluster
  metadata:
    name: "${CLUSTER_NAME}"
  spec:
    projectID: "${PACKET_PROJECT_ID}"
    facility: "${FACILITY}"
  ---
  apiVersion: cluster.x-k8s.io/v1alpha3
  kind: MachineDeployment
  metadata:
    name: ${CLUSTER_NAME}-worker-a
    labels:
      cluster.x-k8s.io/cluster-name: ${CLUSTER_NAME}
      pool: worker-a
  spec:
    replicas: ${WORKER_MACHINE_COUNT}
    clusterName: ${CLUSTER_NAME}
    selector:
      matchLabels:
        cluster.x-k8s.io/cluster-name: ${CLUSTER_NAME}
        pool: worker-a
    template:
      metadata:
        labels:
          cluster.x-k8s.io/cluster-name: ${CLUSTER_NAME}
          pool: worker-a
      spec:
        version: ${KUBERNETES_VERSION}
        clusterName: ${CLUSTER_NAME}
        bootstrap:
          configRef:
            name: ${CLUSTER_NAME}-worker-a
            apiVersion: bootstrap.cluster.x-k8s.io/v1alpha3
            kind: TalosConfigTemplate
        infrastructureRef:
          name: ${CLUSTER_NAME}-worker-a
          apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
          kind: PacketMachineTemplate
  ---
  apiVersion: infrastructure.cluster.x-k8s.io/v1alpha3
  kind: PacketMachineTemplate
  metadata:
    name: ${CLUSTER_NAME}-worker-a
  spec:
    template:
      spec:
        OS: custom_ipxe
        ipxeURL: "http://${IPXE_SERVER_IP}:8080/ipxe?arch=amd64"
        billingCycle: hourly
        machineType: "${WORKER_NODE_TYPE}"
        sshKeys:
          - "${SSH_KEY}"
        tags: []
  ---
  apiVersion: bootstrap.cluster.x-k8s.io/v1alpha3
  kind: TalosConfigTemplate
  metadata:
    name: ${CLUSTER_NAME}-worker-a
    labels:
      cluster.x-k8s.io/cluster-name: ${CLUSTER_NAME}
  spec:
    template:
      spec:
        generateType: init
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Inside of &lt;/span&gt;&lt;code&gt;TalosControlPlane.spec.controlPlaneConfig.init&lt;/code&gt;&lt;span&gt;, I'm very much liking the use of &lt;/span&gt;&lt;code&gt;generateType: init&lt;/code&gt;&lt;span&gt; paired with &lt;/span&gt;&lt;code&gt;configPatches&lt;/code&gt;&lt;span&gt;. This enables:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;configuration to be generated;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;management of certificates out of the cluster operator's hands;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;another level of standardisation; and&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;overrides to be added where needed&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;Notes:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;the ClusterAPI template above uses Packet-Cloud-Controller manager version 1.1.0&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-3"&gt;&lt;h3 class="firn-headline firn-headline-3" id="templating-your-configuration"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Templating your configuration&lt;/span&gt;&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Set environment variables for configuration:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-bash"&gt;&lt;code class="language-bash"&gt;  &lt;&lt;cluster-config-env-name&gt;&gt;
  export FACILITY=sjc1
  export KUBERNETES_VERSION=v1.20.2
  export POD_CIDR=10.244.0.0/16
  export SERVICE_CIDR=10.96.0.0/12
  export CONTROLPLANE_NODE_TYPE=c1.small.x86
  export CONTROL_PLANE_MACHINE_COUNT=3
  export WORKER_NODE_TYPE=c1.small.x86
  export WORKER_MACHINE_COUNT=0
  export SSH_KEY=""
  export IPXE_URL=$LOAD_BALANCER_IP
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;In the variables above, we will create a cluster which has three small controlPlane nodes to run workloads.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-3"&gt;&lt;h3 class="firn-headline firn-headline-3" id="render-the-manifests"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Render the manifests&lt;/span&gt;&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Render your cluster configuration from the template:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  clusterctl config cluster "$CLUSTER_NAME" \
    --from ./talos-packet-cluster-template.yaml \
    -n "$CLUSTER_NAME" &gt; "$CLUSTER_NAME"-cluster-capi.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="creating-the-cluster"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Creating the cluster&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;With the template for the cluster rendered to how wish to deploy it, it's now time to apply it:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl create ns "$CLUSTER_NAME"
  kubectl -n "$CLUSTER_NAME" apply -f ./"$CLUSTER_NAME"-cluster-capi.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;The cluster will now be brought up, we can see the progress by taking a look at the resources:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n "$CLUSTER_NAME" get machines,clusters,packetmachines,packetclusters
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Note: As expected, the cluster may take some time to appear and be accessible.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Not long after applying, a KubeConfig is available. Fetch the KubeConfig from the existing cluster with:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n "$CLUSTER_NAME" get secrets \
    "$CLUSTER_NAME"-kubeconfig -o=jsonpath='{.data.value}' \
    | base64 -d &gt; $HOME/.kube/"$CLUSTER_NAME"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Using the KubeConfig from the new cluster, check out the status of it:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl --kubeconfig $HOME/.kube/"$CLUSTER_NAME" cluster-info
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Once the APIServer is reachable, create configuration for how the Packet-Cloud-Controller-Manager should talk to Equinix-Metal:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl --kubeconfig $HOME/.kube/"$CLUSTER_NAME" -n kube-system \
    create secret generic packet-cloud-config \
    --from-literal=cloud-sa.json="{\"apiKey\": \"${PACKET_API_KEY}\",\"projectID\": \"${PACKET_PROJECT_ID}\"}"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Since we're able to talk to the APIServer, we can check how all Pods are doing:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-bash"&gt;&lt;code class="language-bash"&gt;  &lt;&lt;cluster-config-env-name&gt;&gt;
  kubectl --kubeconfig $HOME/.kube/"$CLUSTER_NAME"\
    -n kube-system get pods
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Listing Pods shows that everything is live and in a good state:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-bash"&gt;&lt;code class="language-bash"&gt;NAMESPACE     NAME                                                     READY   STATUS    RESTARTS   AGE
kube-system   coredns-5b55f9f688-fb2cb                                 1/1     Running   0          25m
kube-system   coredns-5b55f9f688-qsvg5                                 1/1     Running   0          25m
kube-system   kube-apiserver-665px                                     1/1     Running   0          19m
kube-system   kube-apiserver-mz68q                                     1/1     Running   0          19m
kube-system   kube-apiserver-qfklt                                     1/1     Running   2          19m
kube-system   kube-controller-manager-6grxd                            1/1     Running   0          19m
kube-system   kube-controller-manager-cf76h                            1/1     Running   0          19m
kube-system   kube-controller-manager-dsmgf                            1/1     Running   0          19m
kube-system   kube-flannel-brdxw                                       1/1     Running   0          24m
kube-system   kube-flannel-dm85d                                       1/1     Running   0          24m
kube-system   kube-flannel-sg6k9                                       1/1     Running   0          24m
kube-system   kube-proxy-flx59                                         1/1     Running   0          24m
kube-system   kube-proxy-gbn4l                                         1/1     Running   0          24m
kube-system   kube-proxy-ns84v                                         1/1     Running   0          24m
kube-system   kube-scheduler-4qhjw                                     1/1     Running   0          19m
kube-system   kube-scheduler-kbm5z                                     1/1     Running   0          19m
kube-system   kube-scheduler-klsmp                                     1/1     Running   0          19m
kube-system   packet-cloud-controller-manager-77cd8c9c7c-cdzfv         1/1     Running   0          20m
kube-system   pod-checkpointer-4szh6                                   1/1     Running   0          19m
kube-system   pod-checkpointer-4szh6-talos-metal-control-plane-j29lb   1/1     Running   0          19m
kube-system   pod-checkpointer-k7w8h                                   1/1     Running   0          19m
kube-system   pod-checkpointer-k7w8h-talos-metal-control-plane-lk9f2   1/1     Running   0          19m
kube-system   pod-checkpointer-m5wrh                                   1/1     Running   0          19m
kube-system   pod-checkpointer-m5wrh-talos-metal-control-plane-h9v4j   1/1     Running   0          19m
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;With the cluster live, it's now ready for workloads to be deployed!&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="talos-configuration"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Talos Configuration&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;In order to manage Talos Nodes outside of Kubernetes, we need to create and set up configuration to use.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Create the directory for the config:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  mkdir -p $HOME/.talos
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Discover the IP for the first controlPlane:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  export TALOS_ENDPOINT=$(kubectl -n "$CLUSTER_NAME" \
    get machines \
    $(kubectl -n "$CLUSTER_NAME" \
      get machines -l cluster.x-k8s.io/control-plane='' \
      --no-headers --output=jsonpath='{.items[0].metadata.name}') \
      -o=jsonpath="{.status.addresses[?(@.type=='ExternalIP')].address}" | awk '{print $2}')
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Fetch the &lt;/span&gt;&lt;code&gt;talosconfig&lt;/code&gt;&lt;span&gt; from the existing cluster:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl get talosconfig \
    -n $CLUSTER_NAME \
    -l cluster.x-k8s.io/cluster-name=$CLUSTER_NAME \
    -o yaml -o jsonpath='{.items[0].status.talosConfig}' &gt; $HOME/.talos/"$CLUSTER_NAME"-management-plane-talosconfig.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Write in the configuration the endpoint IP and node IP:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  talosctl \
    --talosconfig $HOME/.talos/"$CLUSTER_NAME"-management-plane-talosconfig.yaml \
    config endpoint $TALOS_ENDPOINT
  talosctl \
    --talosconfig $HOME/.talos/"$CLUSTER_NAME"-management-plane-talosconfig.yaml \
    config node $TALOS_ENDPOINT
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Now that the &lt;/span&gt;&lt;code&gt;talosconfig&lt;/code&gt;&lt;span&gt; has been written, try listing all containers:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-bash"&gt;&lt;code class="language-bash"&gt;  &lt;&lt;cluster-config-env-name&gt;&gt;
  # removing ip; omit ` | sed ...` for regular use
  talosctl --talosconfig $HOME/.talos/"$CLUSTER_NAME"-management-plane-talosconfig.yaml containers | sed -r 's/(\b[0-9]{1,3}\.){3}[0-9]{1,3}\b'/"x.x.x.x      "/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;Here's the containers running on this particular node, in containerd (not k8s related):&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-bash"&gt;&lt;code class="language-bash"&gt;NODE            NAMESPACE   ID         IMAGE                                  PID    STATUS
x.x.x.x         system      apid       talos/apid                             3046   RUNNING
x.x.x.x         system      etcd       gcr.io/etcd-development/etcd:v3.4.14   3130   RUNNING
x.x.x.x         system      networkd   talos/networkd                         2879   RUNNING
x.x.x.x         system      routerd    talos/routerd                          2888   RUNNING
x.x.x.x         system      timed      talos/timed                            2976   RUNNING
x.x.x.x         system      trustd     talos/trustd                           3047   RUNNING
&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="clean-up"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Clean up&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Tearing down the entire cluster and resources associated with it, can be achieved by&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;i. Deleting the cluster:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl -n "$CLUSTER_NAME" delete cluster "$CLUSTER_NAME"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ii. Deleting the namespace:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  kubectl delete ns "$CLUSTER_NAME"
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;iii. Removing local configurations:&lt;/span&gt;&lt;/p&gt;&lt;pre class="language-tmate"&gt;&lt;code class="language-tmate"&gt;  rm \
    $HOME/.talos/"$CLUSTER_NAME"-management-plane-talosconfig.yaml \
    $HOME/.kube/"$CLUSTER_NAME"
&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="what-have-i-learned-from-this?"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;What have I learned from this?&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;(always learning) how wonderful the Kubernetes community is :: there are so many knowledgable individuals who are so ready for collaboration and adoption - it doesn't matter the SIG or group.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;how modular Cluster-API is :: Cluster-API components (bootstrap, controlPlane, core, infrastructure) can be swapped out and meshed together in very cool ways.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="credits"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Credits&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Integrating Talos into this project would not be possible without help from &lt;/span&gt;&lt;a class="firn-external" href="https://github.com/andrewrynhard" target="_blank"&gt;Andrew Rynhard (Talos Systems)&lt;/a&gt;&lt;span&gt;, huge thanks to him for reaching out for pairing and co-authoring.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="notes-and-references"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Notes and references&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;with the new cluster's controlPlane live and available for deployment, the iPXE server could be moved into that cluster - meaning that new servers boot from the cluster that they'll join, making it almost self-contained&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;cluster configuration as based off of &lt;/span&gt;&lt;a class="firn-external" href="https://github.com/kubernetes-sigs/cluster-api-provider-packet/blob/479faf06e1337b1e979cb624ca8be015b2a89cde/templates/cluster-template.yaml" target="_blank"&gt;cluster-template.yaml from the cluster-api-provider-packet repo&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;this post has been made to &lt;/span&gt;&lt;a class="firn-external" href="https://blog.calebwoodbine.com/deploying-talos-and-kubernetes-with-cluster-api-on-equinix-metal" target="_blank"&gt;blog.calebwoodine.com&lt;/a&gt;&lt;span&gt;, and &lt;/span&gt;&lt;a class="firn-external" href="https://ii.coop/deploying-talos-and-kubernetes-with-cluster-api-on-equinix-metal/" target="_blank"&gt;talos-system.com/blog&lt;/a&gt;&lt;span&gt;, but is also available as an &lt;/span&gt;&lt;a class="firn-external" href="https://github.com/ii/org/blob/master/ii/equinix-metal-capi-talos-kubernetes/README.org" target="_blank"&gt;Org file&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;hr /&gt;&lt;p&gt;&lt;span&gt;Hope you've enjoyed the output of this project!
Thank you!&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="footnotes"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Footnotes&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/article&gt;&lt;section id="recent"&gt;&lt;h2&gt;Recent Posts&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;a class="title" href="deploying-talos-to-equinix"&gt;Cluster-API + Talos + Equinix Metal&lt;/a&gt;&lt;p&gt;A guide to  launching a highly-available cluster with Equinix and Talos&lt;/p&gt;&lt;p&gt;&lt;em&gt;2021-01-21&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;a class="title" href="working-with-orgmode-tables"&gt;Working with Org-Mode Tables: Basics&lt;/a&gt;&lt;p&gt;An introduction to how to create/edit tables with Org-Mode.&lt;/p&gt;&lt;p&gt;&lt;em&gt;2019-03-09&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/main&gt;&lt;/body&gt;&lt;/html&gt;</description><pubDate>Thu, 21 Jan 2021 00:00:00 +0000</pubDate><title>Cluster-API + Talos + Equinix Metal</title><link>deploying-talos-to-equinix</link></item><item><description>&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8" /&gt;&lt;meta content="width=device-width, initial-scale=1.0" name="viewport" /&gt;&lt;meta content="" name="author" /&gt;&lt;meta content="" name="description" /&gt;&lt;title&gt;&lt;/title&gt;&lt;link href="http://localhost:4000/static/css/firn_base.css" rel="stylesheet" /&gt;&lt;link href="http://localhost:4000/static/css/ii.css" rel="stylesheet" /&gt;&lt;/head&gt;&lt;body&gt;&lt;main&gt;&lt;article class="content"&gt;&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="overview"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Overview&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Tables are a great way to document related information in a format that's easy to scan.
This document is an introduction to how to create/edit tables with Org-Mode.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="table-structure"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Table Structure&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Using the &lt;/span&gt;&lt;code&gt;|&lt;/code&gt;&lt;span&gt; character, Org-Mode uses it to form the various cells (fields) within a table.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="table-navigation"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Table Navigation&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Navigating around the table is simple. The &lt;/span&gt;&lt;code&gt;TAB&lt;/code&gt;&lt;span&gt; key will move the cursor forward, while using &lt;/span&gt;&lt;code&gt;Shift-TAB&lt;/code&gt;&lt;span&gt; combination will move the cursor backwards through the table.
To remove any concerns about the layout of the table, using the &lt;/span&gt;&lt;code&gt;TAB&lt;/code&gt;&lt;span&gt; key will normally &lt;/span&gt;&lt;em&gt;&lt;span&gt;re-align&lt;/span&gt;&lt;/em&gt;&lt;span&gt; the table automatically.
While in the &lt;/span&gt;&lt;em&gt;&lt;span&gt;insert mode&lt;/span&gt;&lt;/em&gt;&lt;span&gt; you can use the &lt;/span&gt;&lt;code&gt;Enter&lt;/code&gt;&lt;span&gt; key, also called the &lt;/span&gt;&lt;em&gt;&lt;span&gt;return&lt;/span&gt;&lt;/em&gt;&lt;span&gt; key (&lt;/span&gt;&lt;code&gt;RET&lt;/code&gt;&lt;span&gt;) to move to the next row of the table.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="working-with-columns"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Working with Columns&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;In the following tables, the keyboard sequence &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt; is for the &lt;/span&gt;&lt;em&gt;&lt;span&gt;meta&lt;/span&gt;&lt;/em&gt;&lt;span&gt; key, which is normally the &lt;/span&gt;&lt;code&gt;Alt&lt;/code&gt;&lt;span&gt; key on the standard PC keyboard. The &lt;/span&gt;&lt;code&gt;S&lt;/code&gt;&lt;span&gt; is shorthand for the &lt;/span&gt;&lt;code&gt;Shift&lt;/code&gt;&lt;span&gt; key.
References to &lt;/span&gt;&lt;code&gt;LEFT&lt;/code&gt;&lt;span&gt;, &lt;/span&gt;&lt;code&gt;RIGHT&lt;/code&gt;&lt;span&gt;, &lt;/span&gt;&lt;code&gt;UP&lt;/code&gt;&lt;span&gt;, &lt;/span&gt;&lt;code&gt;DOWN&lt;/code&gt;&lt;span&gt; relate to the arrow keys.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="moving-columns-around"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Moving columns around&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Keyboard Sequence&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Effect&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-LEFT&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Move the current column left&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-RIGHT&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Move the current column right&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="addremove-a-column"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Add/Remove a column&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Keyboard Sequence&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Effect&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-S-LEFT&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Add another column to the table&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-S-RIGHT&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Remove the current focused column&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="working-with-rows"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Working with Rows&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="moving-them-around"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Moving them around&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Keyboard Sequence&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Effect&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-UP&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Move the current row up&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-DOWN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Move the current row down&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-2"&gt;&lt;h2 class="firn-headline firn-headline-2" id="addremove-a-row"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Add/Remove a row&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Keyboard Sequence&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Effect&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-S-UP&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Remove the current focused row&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;M-S-DOWN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Add another row to the table&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;When the cursor is at the end of the table, using the &lt;/span&gt;&lt;code&gt;Enter&lt;/code&gt;&lt;span&gt; key in &lt;/span&gt;&lt;em&gt;&lt;span&gt;insert mode&lt;/span&gt;&lt;/em&gt;&lt;span&gt; &lt;/span&gt;&lt;strong&gt;&lt;span&gt;or&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; &lt;/span&gt;&lt;code&gt;TAB&lt;/code&gt;&lt;span&gt; key will add another row to the table.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="horizontal-lines"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;Horizontal lines&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Keyboard Sequence&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;span&gt;Effect&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;C-c&lt;/code&gt;&lt;span&gt; &lt;/span&gt;&lt;code&gt;-&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Add a horizontal line and keep the cursor at the current position&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;C-c&lt;/code&gt;&lt;span&gt; &lt;/span&gt;&lt;code&gt;RET&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Add a horizontal line and then move the cursor below the new line&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Note:&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; In Org-Mode it's common to use the keyboard sequence, &lt;/span&gt;&lt;em&gt;&lt;span&gt;control&lt;/span&gt;&lt;/em&gt;&lt;span&gt; (&lt;/span&gt;&lt;code&gt;C&lt;/code&gt;&lt;span&gt;) key with the letter &lt;/span&gt;&lt;code&gt;c&lt;/code&gt;&lt;span&gt; before following it with another key.&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;div class="firn-headline-section firn-headline-section-1"&gt;&lt;h1 class="firn-headline firn-headline-1" id="references"&gt;&lt;span class="firn-headline-text"&gt;&lt;span&gt;References&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;a class="firn-external" href="https://orgmode.org/manual/Built_002din-table-editor.html" target="_blank"&gt;Orgmode.org: The built-in table editor&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/article&gt;&lt;section id="recent"&gt;&lt;h2&gt;Recent Posts&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;a class="title" href="deploying-talos-to-equinix"&gt;Cluster-API + Talos + Equinix Metal&lt;/a&gt;&lt;p&gt;A guide to  launching a highly-available cluster with Equinix and Talos&lt;/p&gt;&lt;p&gt;&lt;em&gt;2021-01-21&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;a class="title" href="working-with-orgmode-tables"&gt;Working with Org-Mode Tables: Basics&lt;/a&gt;&lt;p&gt;An introduction to how to create/edit tables with Org-Mode.&lt;/p&gt;&lt;p&gt;&lt;em&gt;2019-03-09&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/main&gt;&lt;/body&gt;&lt;/html&gt;</description><pubDate>Sat, 09 Mar 2019 00:00:00 +0000</pubDate><title>Working with Org-Mode Tables: Basics</title><link>working-with-orgmode-tables</link></item></channel></rss>